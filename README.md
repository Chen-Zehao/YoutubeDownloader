# YouTube视频下载器

一个功能强大的YouTube视频下载工具，基于Python和yt-dlp开发。

## 🚀 主要功能

### 🎯 智能画质分析
- **自动识别有声音/无声音格式**：程序会智能分析所有可用格式
- **优先推荐最佳组合**：如果最高画质是无声音格式，自动推荐分离下载+合并方案
- **清晰的格式展示**：
  - 🔊 带音频格式：可直接下载的完整视频
  - 📹 仅视频格式：需要合并音频的高画质视频
  - 💡 智能建议：显示最佳画质合并方案

### 📊 详细下载进度
- **实时网速显示**：如 "8.3MB/s"
- **文件大小信息**：如 "120.5MB/350.2MB"
- **智能时间预估**：自动格式化剩余时间
- **3步骤清晰显示**（最佳画质模式）：
  1. 🎬 步骤1/3 - 下载视频：显示视频下载进度和速度
  2. 🎵 步骤2/3 - 下载音频：显示音频下载进度和速度
  3. 🔧 步骤3/3 - 合并文件：显示合并进度和最终文件大小

### 🔧 FFmpeg集成
- **自动检测和安装**：启动时检测FFmpeg环境
- **一键安装**：自动从GitHub下载官方版本
- **本地文件合并**：支持合并本地视频和音频文件

## 📋 下载选项说明

### 🎯 最佳画质选项（优先推荐）
当检测到最高画质为无音频格式时，会优先显示：
```
🎯 最佳画质 (1080p分离合并，耗时较长)
```
- 下载最高画质视频（如1080p）和音频
- 使用FFmpeg合并为完整视频
- 画质最佳但耗时较长

### 📱 快速下载选项
当有带音频的高画质格式时，提供：
```
📱 快速下载 (720p带音频)
```
- 直接下载完整视频文件
- 速度快，无需合并

### 🎵 仅音频选项
```
🎵 仅音频
```
- 提取音频并转换为MP3格式

## 🎨 界面特性

- **现代化UI**：采用清爽的界面设计
- **实时预览**：显示视频缩略图和详细信息
- **智能提示**：根据格式分析提供最佳下载建议
- **进度可视化**：详细的下载进度和状态显示

## 🔧 技术特点

- **智能格式分析**：自动区分有声音和无声音的视频格式
- **优先级排序**：将最佳画质合并选项置于首位
- **详细进度显示**：网速、文件大小、剩余时间一目了然
- **错误处理**：完善的异常处理和用户提示
- **文件清理**：自动清理临时文件，节省磁盘空间

## 📖 使用说明

1. **输入链接**：粘贴YouTube视频链接
2. **获取信息**：点击"获取视频信息"分析可用格式
3. **查看分析**：程序会显示：
   - 🔊 带音频格式列表
   - 📹 仅视频格式列表（通常画质更高）
   - 💡 最佳合并建议
4. **选择质量**：程序会智能推荐最佳选项
5. **开始下载**：享受详细的进度显示

## 💡 智能推荐示例

### 场景1：最高画质需要合并
```
📋 可用画质分析:

🔊 带音频格式:
• 720p@30fps (mp4) 🔊
• 480p@30fps (mp4) 🔊

📹 仅视频格式（需合并音频）:
• 1080p@60fps (mp4) 📹
• 720p@60fps (mp4) 📹

💡 建议: 1080p视频 + 音频合并 = 最佳画质

推荐选项：
🎯 最佳画质 (1080p分离合并，耗时较长)  ← 优先推荐
📱 快速下载 (720p带音频)
🎵 仅音频
```

### 场景2：最高画质已包含音频
```
推荐选项：
🎯 最佳画质 (1080p带音频)  ← 直接下载
🎵 仅音频
```

这样用户可以：
- 🎯 获得最佳画质（通过智能合并）
- 📊 看到详细的下载进度
- ⚡ 了解每个步骤的耗时
- 🧹 自动清理临时文件

## 🛠️ 构建和运行

### 构建脚本选择

我们提供了两个构建脚本：
- **`build.bat`**：英文版构建脚本（推荐，兼容性更好）
- **`build_zh.bat`**：中文版构建脚本

### 使用方法

**推荐使用英文版构建脚本：**
```bash
双击 build.bat
```

构建脚本功能：
- ✅ 自动检测Python环境
- ✅ 安装所需依赖包
- ✅ 强制更新yt-dlp到最新版本
- ✅ 清理旧的构建文件
- ✅ 使用PyInstaller打包为exe可执行文件

### 关于编码问题

如果在运行构建脚本时看到类似以下错误：
```
'uTube更新了API，需要更新yt-dlp' is not recognized as an internal or external command
'��' is not recognized as an internal or external command
```

**这是Windows批处理文件的中文编码问题，不影响exe文件的生成。**

**解决方案：**
1. **使用 `build.bat`（英文版）**：完全避免编码问题
2. 或者忽略这些错误信息，exe文件仍然可以正常生成和使用

### 构建输出

构建完成后，exe文件位于：
- `dist/YouTube下载器.exe` 或 `dist/main.exe`

## 📄 许可证

MIT License - 详见 LICENSE 文件

## 一键安装（推荐）

**首次使用请直接运行：**
```bash
双击 install.bat
```

安装脚本会自动：
- ✅ 检查并安装Python环境
- ✅ 检查tkinter GUI库
- ✅ 安装所有Python依赖包
- ✅ 尝试自动安装FFmpeg
- ✅ 创建桌面快捷方式

## 使用方法

**方式一：双击运行**
```bash
双击 run.bat
```

**方式二：命令行运行**
```bash
python main.py
```

**使用步骤：**
1. 在"视频网址"输入框中粘贴YouTube视频链接
2. 点击"获取视频信息"查看视频详情
3. 选择下载质量和保存路径
4. 点击"开始下载"

## 环境诊断

如果遇到问题，可以运行：
```bash
双击 check_env.bat
```
会自动诊断所有环境依赖并给出解决方案。

## 支持的视频质量

- 最佳质量(视频+音频)
- 1080p
- 720p  
- 480p
- 360p
- 仅音频(MP3)

## 打包成exe文件

使用PyInstaller将程序打包成exe文件：

```bash
pip install pyinstaller
pyinstaller --onefile --windowed --name "YouTube下载器" main.py
```

## 注意事项

- 请确保网络连接正常
- 部分视频可能由于版权限制无法下载
- 建议在下载前先获取视频信息确认可用性

## 依赖库

- yt-dlp: YouTube视频下载核心库
- tkinter: GUI界面库
- threading: 多线程处理 